"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunk_N_E"] = self["webpackChunk_N_E"] || []).push([["_app-pages-browser_src_services_imageUploadService_ts"],{

/***/ "(app-pages-browser)/./src/services/imageUploadService.ts":
/*!********************************************!*\
  !*** ./src/services/imageUploadService.ts ***!
  \********************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteImage: function() { return /* binding */ deleteImage; },\n/* harmony export */   getImageMetadata: function() { return /* binding */ getImageMetadata; },\n/* harmony export */   optimizeImage: function() { return /* binding */ optimizeImage; },\n/* harmony export */   uploadRestaurantImage: function() { return /* binding */ uploadRestaurantImage; },\n/* harmony export */   validateImage: function() { return /* binding */ validateImage; }\n/* harmony export */ });\n/* harmony import */ var _lib_firebase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/firebase */ \"(app-pages-browser)/./src/lib/firebase.ts\");\n/* harmony import */ var firebase_storage__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! firebase/storage */ \"(app-pages-browser)/./node_modules/firebase/storage/dist/esm/index.esm.js\");\n\n\n// Firebase Storage bağlantısını test et\nasync function testFirebaseStorageConnection() {\n    try {\n        console.log(\"\\uD83D\\uDD25 Firebase Storage bağlantısı test ediliyor...\");\n        // Test dosyası oluştur\n        const testData = new Blob([\n            \"Firebase Storage Test\"\n        ], {\n            type: \"text/plain\"\n        });\n        const testRef = (0,firebase_storage__WEBPACK_IMPORTED_MODULE_1__.ref)(_lib_firebase__WEBPACK_IMPORTED_MODULE_0__.storage, \"test/connection-test.txt\");\n        // Test yüklemesi\n        await (0,firebase_storage__WEBPACK_IMPORTED_MODULE_1__.uploadBytes)(testRef, testData);\n        console.log(\"✅ Firebase Storage yazma testi başarılı\");\n        // Test okuma\n        const downloadURL = await (0,firebase_storage__WEBPACK_IMPORTED_MODULE_1__.getDownloadURL)(testRef);\n        console.log(\"✅ Firebase Storage okuma testi başarılı:\", downloadURL);\n        return true;\n    } catch (error) {\n        console.error(\"❌ Firebase Storage bağlantı testi başarısız:\", error);\n        return false;\n    }\n}\n// Ana kapak görseli yükleme fonksiyonu\nasync function uploadRestaurantImage(file, restaurantId) {\n    let options = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};\n    try {\n        console.log(\"\\uD83D\\uDE80 Kapak g\\xf6rseli y\\xfckleme başlatılıyor...\", {\n            fileName: file.name,\n            fileSize: \"\".concat((file.size / 1024 / 1024).toFixed(2), \" MB\"),\n            fileType: file.type,\n            restaurantId,\n            storageConfig: {\n                bucket: _lib_firebase__WEBPACK_IMPORTED_MODULE_0__.storage.app.options.storageBucket,\n                projectId: _lib_firebase__WEBPACK_IMPORTED_MODULE_0__.storage.app.options.projectId\n            }\n        });\n        // Firebase Storage bağlantısını test et\n        const isStorageConnected = await testFirebaseStorageConnection();\n        if (!isStorageConnected) {\n            throw new Error(\"Firebase Storage bağlantısı kurulamadı. L\\xfctfen Firebase Console'dan Storage'ı etkinleştirin.\");\n        }\n        // Dosya validasyonu\n        const validationResult = validateImage(file);\n        if (!validationResult.isValid) {\n            throw new Error(validationResult.error || \"Ge\\xe7ersiz dosya\");\n        }\n        // Progress callback başlangıç\n        if (options.onProgress) {\n            options.onProgress(10);\n        }\n        // Dosya yolu oluştur\n        const timestamp = Date.now();\n        const fileName = \"\".concat(timestamp, \"_\").concat(file.name.replace(/[^a-zA-Z0-9.-]/g, \"_\"));\n        const folderPath = restaurantId ? \"restaurants/\".concat(restaurantId) : \"restaurants\";\n        const filePath = \"\".concat(folderPath, \"/\").concat(fileName);\n        console.log(\"\\uD83D\\uDCC1 Dosya yolu:\", filePath);\n        // Firebase Storage referansı oluştur\n        const storageRef = (0,firebase_storage__WEBPACK_IMPORTED_MODULE_1__.ref)(_lib_firebase__WEBPACK_IMPORTED_MODULE_0__.storage, filePath);\n        console.log(\"\\uD83D\\uDCCD Storage referansı oluşturuldu:\", storageRef.fullPath);\n        // Progress simulation\n        if (options.onProgress) {\n            options.onProgress(25);\n        }\n        // Dosyayı yükle\n        console.log(\"⬆️ Firebase Storage'a y\\xfckleniyor...\");\n        // Progress simulation during upload\n        const progressInterval = setInterval(()=>{\n            if (options.onProgress) {\n                // Simulate progress between 25-75%\n                const currentProgress = Math.min(75, 25 + Math.random() * 50);\n                options.onProgress(currentProgress);\n            }\n        }, 200);\n        try {\n            const uploadResult = await (0,firebase_storage__WEBPACK_IMPORTED_MODULE_1__.uploadBytes)(storageRef, file);\n            clearInterval(progressInterval);\n            console.log(\"✅ Dosya y\\xfckleme başarılı:\", uploadResult.metadata);\n            if (options.onProgress) {\n                options.onProgress(90);\n            }\n            // Download URL al\n            console.log(\"\\uD83D\\uDD17 Download URL alınıyor...\");\n            const downloadURL = await (0,firebase_storage__WEBPACK_IMPORTED_MODULE_1__.getDownloadURL)(uploadResult.ref);\n            if (options.onProgress) {\n                options.onProgress(100);\n            }\n            console.log(\"✅ Kapak g\\xf6rseli başarıyla y\\xfcklendi:\", downloadURL);\n            return downloadURL;\n        } catch (uploadError) {\n            clearInterval(progressInterval);\n            console.error(\"❌ Upload hatası detayları:\", {\n                error: uploadError,\n                errorMessage: uploadError instanceof Error ? uploadError.message : \"Bilinmeyen hata\",\n                errorCode: uploadError === null || uploadError === void 0 ? void 0 : uploadError.code,\n                storageRef: storageRef.fullPath,\n                fileSize: file.size,\n                fileType: file.type\n            });\n            throw uploadError;\n        }\n    } catch (error) {\n        console.error(\"❌ Kapak g\\xf6rseli y\\xfckleme hatası:\", error);\n        throw handleUploadError(error);\n    }\n}\n// Hata yönetimi fonksiyonu\nfunction handleUploadError(error) {\n    console.error(\"\\uD83D\\uDD0D Hata analizi:\", {\n        errorType: typeof error,\n        errorName: error === null || error === void 0 ? void 0 : error.name,\n        errorMessage: error === null || error === void 0 ? void 0 : error.message,\n        errorCode: error === null || error === void 0 ? void 0 : error.code,\n        errorStack: error === null || error === void 0 ? void 0 : error.stack\n    });\n    if (error instanceof Error) {\n        // Firebase Storage hata kodları\n        if (error.message.includes(\"storage/unauthorized\") || error.message.includes(\"permission-denied\")) {\n            return new Error(\"Yetkilendirme hatası. Firebase Storage kurallarını kontrol edin.\");\n        } else if (error.message.includes(\"storage/quota-exceeded\")) {\n            return new Error(\"Depolama kotası aşıldı.\");\n        } else if (error.message.includes(\"storage/invalid-format\")) {\n            return new Error(\"Ge\\xe7ersiz dosya formatı.\");\n        } else if (error.message.includes(\"storage/object-not-found\")) {\n            return new Error(\"Dosya bulunamadı.\");\n        } else if (error.message.includes(\"storage/canceled\")) {\n            return new Error(\"Y\\xfckleme iptal edildi.\");\n        } else if (error.message.includes(\"storage/unknown\")) {\n            return new Error(\"Firebase Storage hen\\xfcz kurulmamış. L\\xfctfen Firebase Console'dan Storage'ı başlatın.\");\n        } else if (error.message.includes(\"network\") || error.message.includes(\"fetch\")) {\n            return new Error(\"İnternet bağlantısı problemi. L\\xfctfen tekrar deneyin.\");\n        } else if (error.message.includes(\"CORS\")) {\n            return new Error(\"CORS hatası. Firebase Storage konfig\\xfcrasyonunu kontrol edin.\");\n        } else {\n            return new Error(\"Y\\xfckleme hatası: \".concat(error.message));\n        }\n    }\n    return new Error(\"Bilinmeyen bir hata oluştu. L\\xfctfen tekrar deneyin.\");\n}\n// Görsel optimizasyonu (opsiyonel)\nasync function optimizeImage(file) {\n    let options = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};\n    return new Promise((resolve)=>{\n        const canvas = document.createElement(\"canvas\");\n        const ctx = canvas.getContext(\"2d\");\n        const img = new Image();\n        img.onload = ()=>{\n            const { maxWidth = 1920, maxHeight = 1080, quality = 0.8 } = options;\n            let { width, height } = img;\n            // Boyut sınırlaması\n            if (width > maxWidth || height > maxHeight) {\n                const ratio = Math.min(maxWidth / width, maxHeight / height);\n                width *= ratio;\n                height *= ratio;\n            }\n            canvas.width = width;\n            canvas.height = height;\n            ctx === null || ctx === void 0 ? void 0 : ctx.drawImage(img, 0, 0, width, height);\n            canvas.toBlob((blob)=>{\n                if (blob) {\n                    const optimizedFile = new File([\n                        blob\n                    ], file.name, {\n                        type: options.format === \"webp\" ? \"image/webp\" : file.type,\n                        lastModified: Date.now()\n                    });\n                    resolve(optimizedFile);\n                } else {\n                    resolve(file);\n                }\n            }, options.format === \"webp\" ? \"image/webp\" : file.type, quality);\n        };\n        img.src = URL.createObjectURL(file);\n    });\n}\n// Dosya validasyonu\nfunction validateImage(file) {\n    // Dosya boyutu kontrolü (10MB)\n    const maxSize = 10 * 1024 * 1024;\n    if (file.size > maxSize) {\n        return {\n            isValid: false,\n            error: \"Dosya boyutu 10MB'dan b\\xfcy\\xfck olamaz.\"\n        };\n    }\n    // Dosya tipi kontrolü\n    const allowedTypes = [\n        \"image/jpeg\",\n        \"image/jpg\",\n        \"image/png\",\n        \"image/webp\"\n    ];\n    if (!allowedTypes.includes(file.type)) {\n        return {\n            isValid: false,\n            error: \"Sadece JPEG, PNG ve WebP formatları desteklenir.\"\n        };\n    }\n    return {\n        isValid: true\n    };\n}\n// Görsel metadata'sını al\nfunction getImageMetadata(file) {\n    return new Promise((resolve, reject)=>{\n        const img = new Image();\n        img.onload = ()=>{\n            resolve({\n                width: img.naturalWidth,\n                height: img.naturalHeight,\n                format: file.type,\n                size: file.size,\n                aspectRatio: img.naturalWidth / img.naturalHeight\n            });\n        };\n        img.onerror = ()=>reject(new Error(\"G\\xf6rsel metadata alınamadı\"));\n        img.src = URL.createObjectURL(file);\n    });\n}\n// Görsel silme fonksiyonu\nasync function deleteImage(imageUrl) {\n    try {\n        const imageRef = (0,firebase_storage__WEBPACK_IMPORTED_MODULE_1__.ref)(_lib_firebase__WEBPACK_IMPORTED_MODULE_0__.storage, imageUrl);\n        await (0,firebase_storage__WEBPACK_IMPORTED_MODULE_1__.deleteObject)(imageRef);\n        console.log(\"✅ G\\xf6rsel başarıyla silindi\");\n    } catch (error) {\n        console.error(\"❌ G\\xf6rsel silme hatası:\", error);\n        throw new Error(\"G\\xf6rsel silinemedi\");\n    }\n}\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9zZXJ2aWNlcy9pbWFnZVVwbG9hZFNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUF5QztBQUN5QztBQStCbEYsd0NBQXdDO0FBQ3hDLGVBQWVLO0lBQ2IsSUFBSTtRQUNGQyxRQUFRQyxHQUFHLENBQUM7UUFFWix1QkFBdUI7UUFDdkIsTUFBTUMsV0FBVyxJQUFJQyxLQUFLO1lBQUM7U0FBd0IsRUFBRTtZQUFFQyxNQUFNO1FBQWE7UUFDMUUsTUFBTUMsVUFBVVYscURBQUdBLENBQUNELGtEQUFPQSxFQUFFO1FBRTdCLGlCQUFpQjtRQUNqQixNQUFNRSw2REFBV0EsQ0FBQ1MsU0FBU0g7UUFDM0JGLFFBQVFDLEdBQUcsQ0FBQztRQUVaLGFBQWE7UUFDYixNQUFNSyxjQUFjLE1BQU1ULGdFQUFjQSxDQUFDUTtRQUN6Q0wsUUFBUUMsR0FBRyxDQUFDLDRDQUE0Q0s7UUFFeEQsT0FBTztJQUNULEVBQUUsT0FBT0MsT0FBTztRQUNkUCxRQUFRTyxLQUFLLENBQUMsZ0RBQWdEQTtRQUM5RCxPQUFPO0lBQ1Q7QUFDRjtBQUVBLHVDQUF1QztBQUNoQyxlQUFlQyxzQkFDcEJDLElBQVUsRUFDVkMsWUFBcUI7UUFDckJDLFVBQUFBLGlFQUE4QixDQUFDO0lBRS9CLElBQUk7UUFDRlgsUUFBUUMsR0FBRyxDQUFDLDREQUE0QztZQUN0RFcsVUFBVUgsS0FBS0ksSUFBSTtZQUNuQkMsVUFBVSxHQUF3QyxPQUFyQyxDQUFDTCxLQUFLTSxJQUFJLEdBQUcsT0FBTyxJQUFHLEVBQUdDLE9BQU8sQ0FBQyxJQUFHO1lBQ2xEQyxVQUFVUixLQUFLTCxJQUFJO1lBQ25CTTtZQUNBUSxlQUFlO2dCQUNiQyxRQUFRekIsa0RBQU9BLENBQUMwQixHQUFHLENBQUNULE9BQU8sQ0FBQ1UsYUFBYTtnQkFDekNDLFdBQVc1QixrREFBT0EsQ0FBQzBCLEdBQUcsQ0FBQ1QsT0FBTyxDQUFDVyxTQUFTO1lBQzFDO1FBQ0Y7UUFFQSx3Q0FB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Riw4REFBWUEsQ0FBQ2dHO1FBQ25COUYsUUFBUUMsR0FBRyxDQUFDO0lBQ2QsRUFBRSxPQUFPTSxPQUFPO1FBQ2RQLFFBQVFPLEtBQUssQ0FBQyw2QkFBMEJBO1FBQ3hDLE1BQU0sSUFBSWlCLE1BQU07SUFDbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvc2VydmljZXMvaW1hZ2VVcGxvYWRTZXJ2aWNlLnRzP2E3MmYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc3RvcmFnZSB9IGZyb20gJ0AvbGliL2ZpcmViYXNlJztcbmltcG9ydCB7IHJlZiwgdXBsb2FkQnl0ZXMsIGdldERvd25sb2FkVVJMLCBkZWxldGVPYmplY3QgfSBmcm9tICdmaXJlYmFzZS9zdG9yYWdlJztcblxuLy8gSW1hZ2UgVXBsb2FkIE9wdGlvbnMgSW50ZXJmYWNlXG5leHBvcnQgaW50ZXJmYWNlIEltYWdlVXBsb2FkT3B0aW9ucyB7XG4gIG1heFNpemU/OiBudW1iZXI7IC8vIE1CIGNpbnNpbmRlblxuICBxdWFsaXR5PzogbnVtYmVyOyAvLyAwLjEgLSAxLjAgYXJhc8SxXG4gIG1heFdpZHRoPzogbnVtYmVyO1xuICBtYXhIZWlnaHQ/OiBudW1iZXI7XG4gIGZvcm1hdD86ICd3ZWJwJyB8ICdqcGVnJyB8ICdwbmcnIHwgJ2F1dG8nO1xuICBmb2xkZXI/OiBzdHJpbmc7XG4gIGdlbmVyYXRlVGh1bWJuYWlsPzogYm9vbGVhbjtcbiAgYWlPcHRpbWl6YXRpb24/OiBib29sZWFuO1xuICBvblByb2dyZXNzPzogKHByb2dyZXNzOiBudW1iZXIpID0+IHZvaWQ7XG59XG5cbi8vIFVwbG9hZCBQcm9ncmVzcyBJbnRlcmZhY2VcbmV4cG9ydCBpbnRlcmZhY2UgVXBsb2FkUHJvZ3Jlc3Mge1xuICBwcm9ncmVzczogbnVtYmVyOyAvLyAwLTEwMFxuICBzdGF0dXM6ICd1cGxvYWRpbmcnIHwgJ3Byb2Nlc3NpbmcnIHwgJ2NvbXBsZXRlJyB8ICdlcnJvcic7XG4gIG1lc3NhZ2U/OiBzdHJpbmc7XG59XG5cbi8vIEltYWdlIE1ldGFkYXRhIEludGVyZmFjZVxuZXhwb3J0IGludGVyZmFjZSBJbWFnZU1ldGFkYXRhIHtcbiAgd2lkdGg6IG51bWJlcjtcbiAgaGVpZ2h0OiBudW1iZXI7XG4gIHNpemU6IG51bWJlcjtcbiAgZm9ybWF0OiBzdHJpbmc7XG4gIGFzcGVjdFJhdGlvOiBudW1iZXI7XG59XG5cbi8vIEZpcmViYXNlIFN0b3JhZ2UgYmHEn2xhbnTEsXPEsW7EsSB0ZXN0IGV0XG5hc3luYyBmdW5jdGlvbiB0ZXN0RmlyZWJhc2VTdG9yYWdlQ29ubmVjdGlvbigpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygn8J+UpSBGaXJlYmFzZSBTdG9yYWdlIGJhxJ9sYW50xLFzxLEgdGVzdCBlZGlsaXlvci4uLicpO1xuICAgIFxuICAgIC8vIFRlc3QgZG9zeWFzxLEgb2x1xZ90dXJcbiAgICBjb25zdCB0ZXN0RGF0YSA9IG5ldyBCbG9iKFsnRmlyZWJhc2UgU3RvcmFnZSBUZXN0J10sIHsgdHlwZTogJ3RleHQvcGxhaW4nIH0pO1xuICAgIGNvbnN0IHRlc3RSZWYgPSByZWYoc3RvcmFnZSwgJ3Rlc3QvY29ubmVjdGlvbi10ZXN0LnR4dCcpO1xuICAgIFxuICAgIC8vIFRlc3QgecO8a2xlbWVzaVxuICAgIGF3YWl0IHVwbG9hZEJ5dGVzKHRlc3RSZWYsIHRlc3REYXRhKTtcbiAgICBjb25zb2xlLmxvZygn4pyFIEZpcmViYXNlIFN0b3JhZ2UgeWF6bWEgdGVzdGkgYmHFn2FyxLFsxLEnKTtcbiAgICBcbiAgICAvLyBUZXN0IG9rdW1hXG4gICAgY29uc3QgZG93bmxvYWRVUkwgPSBhd2FpdCBnZXREb3dubG9hZFVSTCh0ZXN0UmVmKTtcbiAgICBjb25zb2xlLmxvZygn4pyFIEZpcmViYXNlIFN0b3JhZ2Ugb2t1bWEgdGVzdGkgYmHFn2FyxLFsxLE6JywgZG93bmxvYWRVUkwpO1xuICAgIFxuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBGaXJlYmFzZSBTdG9yYWdlIGJhxJ9sYW50xLEgdGVzdGkgYmHFn2FyxLFzxLF6OicsIGVycm9yKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuLy8gQW5hIGthcGFrIGfDtnJzZWxpIHnDvGtsZW1lIGZvbmtzaXlvbnVcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGxvYWRSZXN0YXVyYW50SW1hZ2UoXG4gIGZpbGU6IEZpbGUsXG4gIHJlc3RhdXJhbnRJZD86IHN0cmluZyxcbiAgb3B0aW9uczogSW1hZ2VVcGxvYWRPcHRpb25zID0ge31cbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ/CfmoAgS2FwYWsgZ8O2cnNlbGkgecO8a2xlbWUgYmHFn2xhdMSxbMSxeW9yLi4uJywge1xuICAgICAgZmlsZU5hbWU6IGZpbGUubmFtZSxcbiAgICAgIGZpbGVTaXplOiBgJHsoZmlsZS5zaXplIC8gMTAyNCAvIDEwMjQpLnRvRml4ZWQoMil9IE1CYCxcbiAgICAgIGZpbGVUeXBlOiBmaWxlLnR5cGUsXG4gICAgICByZXN0YXVyYW50SWQsXG4gICAgICBzdG9yYWdlQ29uZmlnOiB7XG4gICAgICAgIGJ1Y2tldDogc3RvcmFnZS5hcHAub3B0aW9ucy5zdG9yYWdlQnVja2V0LFxuICAgICAgICBwcm9qZWN0SWQ6IHN0b3JhZ2UuYXBwLm9wdGlvbnMucHJvamVjdElkXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBGaXJlYmFzZSBTdG9yYWdlIGJhxJ9sYW50xLFzxLFuxLEgdGVzdCBldFxuICAgIGNvbnN0IGlzU3RvcmFnZUNvbm5lY3RlZCA9IGF3YWl0IHRlc3RGaXJlYmFzZVN0b3JhZ2VDb25uZWN0aW9uKCk7XG4gICAgaWYgKCFpc1N0b3JhZ2VDb25uZWN0ZWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmlyZWJhc2UgU3RvcmFnZSBiYcSfbGFudMSxc8SxIGt1cnVsYW1hZMSxLiBMw7x0ZmVuIEZpcmViYXNlIENvbnNvbGVcXCdkYW4gU3RvcmFnZVxcJ8SxIGV0a2lubGXFn3RpcmluLicpO1xuICAgIH1cblxuICAgIC8vIERvc3lhIHZhbGlkYXN5b251XG4gICAgY29uc3QgdmFsaWRhdGlvblJlc3VsdCA9IHZhbGlkYXRlSW1hZ2UoZmlsZSk7XG4gICAgaWYgKCF2YWxpZGF0aW9uUmVzdWx0LmlzVmFsaWQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcih2YWxpZGF0aW9uUmVzdWx0LmVycm9yIHx8ICdHZcOnZXJzaXogZG9zeWEnKTtcbiAgICB9XG5cbiAgICAvLyBQcm9ncmVzcyBjYWxsYmFjayBiYcWfbGFuZ8Sxw6dcbiAgICBpZiAob3B0aW9ucy5vblByb2dyZXNzKSB7XG4gICAgICBvcHRpb25zLm9uUHJvZ3Jlc3MoMTApO1xuICAgIH1cblxuICAgIC8vIERvc3lhIHlvbHUgb2x1xZ90dXJcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGZpbGVOYW1lID0gYCR7dGltZXN0YW1wfV8ke2ZpbGUubmFtZS5yZXBsYWNlKC9bXmEtekEtWjAtOS4tXS9nLCAnXycpfWA7XG4gICAgY29uc3QgZm9sZGVyUGF0aCA9IHJlc3RhdXJhbnRJZCA/IGByZXN0YXVyYW50cy8ke3Jlc3RhdXJhbnRJZH1gIDogJ3Jlc3RhdXJhbnRzJztcbiAgICBjb25zdCBmaWxlUGF0aCA9IGAke2ZvbGRlclBhdGh9LyR7ZmlsZU5hbWV9YDtcblxuICAgIGNvbnNvbGUubG9nKCfwn5OBIERvc3lhIHlvbHU6JywgZmlsZVBhdGgpO1xuXG4gICAgLy8gRmlyZWJhc2UgU3RvcmFnZSByZWZlcmFuc8SxIG9sdcWfdHVyXG4gICAgY29uc3Qgc3RvcmFnZVJlZiA9IHJlZihzdG9yYWdlLCBmaWxlUGF0aCk7XG4gICAgY29uc29sZS5sb2coJ/Cfk40gU3RvcmFnZSByZWZlcmFuc8SxIG9sdcWfdHVydWxkdTonLCBzdG9yYWdlUmVmLmZ1bGxQYXRoKTtcblxuICAgIC8vIFByb2dyZXNzIHNpbXVsYXRpb25cbiAgICBpZiAob3B0aW9ucy5vblByb2dyZXNzKSB7XG4gICAgICBvcHRpb25zLm9uUHJvZ3Jlc3MoMjUpO1xuICAgIH1cblxuICAgIC8vIERvc3lhecSxIHnDvGtsZVxuICAgIGNvbnNvbGUubG9nKCfirIbvuI8gRmlyZWJhc2UgU3RvcmFnZVxcJ2EgecO8a2xlbml5b3IuLi4nKTtcbiAgICBcbiAgICAvLyBQcm9ncmVzcyBzaW11bGF0aW9uIGR1cmluZyB1cGxvYWRcbiAgICBjb25zdCBwcm9ncmVzc0ludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgaWYgKG9wdGlvbnMub25Qcm9ncmVzcykge1xuICAgICAgICAvLyBTaW11bGF0ZSBwcm9ncmVzcyBiZXR3ZWVuIDI1LTc1JVxuICAgICAgICBjb25zdCBjdXJyZW50UHJvZ3Jlc3MgPSBNYXRoLm1pbig3NSwgMjUgKyBNYXRoLnJhbmRvbSgpICogNTApO1xuICAgICAgICBvcHRpb25zLm9uUHJvZ3Jlc3MoY3VycmVudFByb2dyZXNzKTtcbiAgICAgIH1cbiAgICB9LCAyMDApO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVwbG9hZFJlc3VsdCA9IGF3YWl0IHVwbG9hZEJ5dGVzKHN0b3JhZ2VSZWYsIGZpbGUpO1xuICAgICAgY2xlYXJJbnRlcnZhbChwcm9ncmVzc0ludGVydmFsKTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ+KchSBEb3N5YSB5w7xrbGVtZSBiYcWfYXLEsWzEsTonLCB1cGxvYWRSZXN1bHQubWV0YWRhdGEpO1xuICAgICAgXG4gICAgICBpZiAob3B0aW9ucy5vblByb2dyZXNzKSB7XG4gICAgICAgIG9wdGlvbnMub25Qcm9ncmVzcyg5MCk7XG4gICAgICB9XG5cbiAgICAgIC8vIERvd25sb2FkIFVSTCBhbFxuICAgICAgY29uc29sZS5sb2coJ/CflJcgRG93bmxvYWQgVVJMIGFsxLFuxLF5b3IuLi4nKTtcbiAgICAgIGNvbnN0IGRvd25sb2FkVVJMID0gYXdhaXQgZ2V0RG93bmxvYWRVUkwodXBsb2FkUmVzdWx0LnJlZik7XG5cbiAgICAgIGlmIChvcHRpb25zLm9uUHJvZ3Jlc3MpIHtcbiAgICAgICAgb3B0aW9ucy5vblByb2dyZXNzKDEwMCk7XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUubG9nKCfinIUgS2FwYWsgZ8O2cnNlbGkgYmHFn2FyxLF5bGEgecO8a2xlbmRpOicsIGRvd25sb2FkVVJMKTtcbiAgICAgIHJldHVybiBkb3dubG9hZFVSTDtcblxuICAgIH0gY2F0Y2ggKHVwbG9hZEVycm9yKSB7XG4gICAgICBjbGVhckludGVydmFsKHByb2dyZXNzSW50ZXJ2YWwpO1xuICAgICAgY29uc29sZS5lcnJvcign4p2MIFVwbG9hZCBoYXRhc8SxIGRldGF5bGFyxLE6Jywge1xuICAgICAgICBlcnJvcjogdXBsb2FkRXJyb3IsXG4gICAgICAgIGVycm9yTWVzc2FnZTogdXBsb2FkRXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IHVwbG9hZEVycm9yLm1lc3NhZ2UgOiAnQmlsaW5tZXllbiBoYXRhJyxcbiAgICAgICAgZXJyb3JDb2RlOiAodXBsb2FkRXJyb3IgYXMgYW55KT8uY29kZSxcbiAgICAgICAgc3RvcmFnZVJlZjogc3RvcmFnZVJlZi5mdWxsUGF0aCxcbiAgICAgICAgZmlsZVNpemU6IGZpbGUuc2l6ZSxcbiAgICAgICAgZmlsZVR5cGU6IGZpbGUudHlwZVxuICAgICAgfSk7XG4gICAgICB0aHJvdyB1cGxvYWRFcnJvcjtcbiAgICB9XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgS2FwYWsgZ8O2cnNlbGkgecO8a2xlbWUgaGF0YXPEsTonLCBlcnJvcik7XG4gICAgdGhyb3cgaGFuZGxlVXBsb2FkRXJyb3IoZXJyb3IpO1xuICB9XG59XG5cbi8vIEhhdGEgecO2bmV0aW1pIGZvbmtzaXlvbnVcbmZ1bmN0aW9uIGhhbmRsZVVwbG9hZEVycm9yKGVycm9yOiBhbnkpOiBFcnJvciB7XG4gIGNvbnNvbGUuZXJyb3IoJ/CflI0gSGF0YSBhbmFsaXppOicsIHtcbiAgICBlcnJvclR5cGU6IHR5cGVvZiBlcnJvcixcbiAgICBlcnJvck5hbWU6IGVycm9yPy5uYW1lLFxuICAgIGVycm9yTWVzc2FnZTogZXJyb3I/Lm1lc3NhZ2UsXG4gICAgZXJyb3JDb2RlOiBlcnJvcj8uY29kZSxcbiAgICBlcnJvclN0YWNrOiBlcnJvcj8uc3RhY2tcbiAgfSk7XG5cbiAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAvLyBGaXJlYmFzZSBTdG9yYWdlIGhhdGEga29kbGFyxLFcbiAgICBpZiAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnc3RvcmFnZS91bmF1dGhvcml6ZWQnKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdwZXJtaXNzaW9uLWRlbmllZCcpKSB7XG4gICAgICByZXR1cm4gbmV3IEVycm9yKCdZZXRraWxlbmRpcm1lIGhhdGFzxLEuIEZpcmViYXNlIFN0b3JhZ2Uga3VyYWxsYXLEsW7EsSBrb250cm9sIGVkaW4uJyk7XG4gICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdzdG9yYWdlL3F1b3RhLWV4Y2VlZGVkJykpIHtcbiAgICAgIHJldHVybiBuZXcgRXJyb3IoJ0RlcG9sYW1hIGtvdGFzxLEgYcWfxLFsZMSxLicpO1xuICAgIH0gZWxzZSBpZiAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcygnc3RvcmFnZS9pbnZhbGlkLWZvcm1hdCcpKSB7XG4gICAgICByZXR1cm4gbmV3IEVycm9yKCdHZcOnZXJzaXogZG9zeWEgZm9ybWF0xLEuJyk7XG4gICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdzdG9yYWdlL29iamVjdC1ub3QtZm91bmQnKSkge1xuICAgICAgcmV0dXJuIG5ldyBFcnJvcignRG9zeWEgYnVsdW5hbWFkxLEuJyk7XG4gICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdzdG9yYWdlL2NhbmNlbGVkJykpIHtcbiAgICAgIHJldHVybiBuZXcgRXJyb3IoJ1nDvGtsZW1lIGlwdGFsIGVkaWxkaS4nKTtcbiAgICB9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ3N0b3JhZ2UvdW5rbm93bicpKSB7XG4gICAgICByZXR1cm4gbmV3IEVycm9yKCdGaXJlYmFzZSBTdG9yYWdlIGhlbsO8eiBrdXJ1bG1hbcSxxZ8uIEzDvHRmZW4gRmlyZWJhc2UgQ29uc29sZVxcJ2RhbiBTdG9yYWdlXFwnxLEgYmHFn2xhdMSxbi4nKTtcbiAgICB9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ25ldHdvcmsnKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKCdmZXRjaCcpKSB7XG4gICAgICByZXR1cm4gbmV3IEVycm9yKCfEsG50ZXJuZXQgYmHEn2xhbnTEsXPEsSBwcm9ibGVtaS4gTMO8dGZlbiB0ZWtyYXIgZGVuZXlpbi4nKTtcbiAgICB9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0NPUlMnKSkge1xuICAgICAgcmV0dXJuIG5ldyBFcnJvcignQ09SUyBoYXRhc8SxLiBGaXJlYmFzZSBTdG9yYWdlIGtvbmZpZ8O8cmFzeW9udW51IGtvbnRyb2wgZWRpbi4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5ldyBFcnJvcihgWcO8a2xlbWUgaGF0YXPEsTogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxuICBcbiAgcmV0dXJuIG5ldyBFcnJvcignQmlsaW5tZXllbiBiaXIgaGF0YSBvbHXFn3R1LiBMw7x0ZmVuIHRla3JhciBkZW5leWluLicpO1xufVxuXG4vLyBHw7Zyc2VsIG9wdGltaXphc3lvbnUgKG9wc2l5b25lbClcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBvcHRpbWl6ZUltYWdlKGZpbGU6IEZpbGUsIG9wdGlvbnM6IEltYWdlVXBsb2FkT3B0aW9ucyA9IHt9KTogUHJvbWlzZTxGaWxlPiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpO1xuICAgIGNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xuICAgIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpO1xuXG4gICAgaW1nLm9ubG9hZCA9ICgpID0+IHtcbiAgICAgIGNvbnN0IHsgbWF4V2lkdGggPSAxOTIwLCBtYXhIZWlnaHQgPSAxMDgwLCBxdWFsaXR5ID0gMC44IH0gPSBvcHRpb25zO1xuICAgICAgXG4gICAgICBsZXQgeyB3aWR0aCwgaGVpZ2h0IH0gPSBpbWc7XG4gICAgICBcbiAgICAgIC8vIEJveXV0IHPEsW7EsXJsYW1hc8SxXG4gICAgICBpZiAod2lkdGggPiBtYXhXaWR0aCB8fCBoZWlnaHQgPiBtYXhIZWlnaHQpIHtcbiAgICAgICAgY29uc3QgcmF0aW8gPSBNYXRoLm1pbihtYXhXaWR0aCAvIHdpZHRoLCBtYXhIZWlnaHQgLyBoZWlnaHQpO1xuICAgICAgICB3aWR0aCAqPSByYXRpbztcbiAgICAgICAgaGVpZ2h0ICo9IHJhdGlvO1xuICAgICAgfVxuXG4gICAgICBjYW52YXMud2lkdGggPSB3aWR0aDtcbiAgICAgIGNhbnZhcy5oZWlnaHQgPSBoZWlnaHQ7XG4gICAgICBcbiAgICAgIGN0eD8uZHJhd0ltYWdlKGltZywgMCwgMCwgd2lkdGgsIGhlaWdodCk7XG4gICAgICBcbiAgICAgIGNhbnZhcy50b0Jsb2IoXG4gICAgICAgIChibG9iKSA9PiB7XG4gICAgICAgICAgaWYgKGJsb2IpIHtcbiAgICAgICAgICAgIGNvbnN0IG9wdGltaXplZEZpbGUgPSBuZXcgRmlsZShbYmxvYl0sIGZpbGUubmFtZSwge1xuICAgICAgICAgICAgICB0eXBlOiBvcHRpb25zLmZvcm1hdCA9PT0gJ3dlYnAnID8gJ2ltYWdlL3dlYnAnIDogZmlsZS50eXBlLFxuICAgICAgICAgICAgICBsYXN0TW9kaWZpZWQ6IERhdGUubm93KClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmVzb2x2ZShvcHRpbWl6ZWRGaWxlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVzb2x2ZShmaWxlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIG9wdGlvbnMuZm9ybWF0ID09PSAnd2VicCcgPyAnaW1hZ2Uvd2VicCcgOiBmaWxlLnR5cGUsXG4gICAgICAgIHF1YWxpdHlcbiAgICAgICk7XG4gICAgfTtcblxuICAgIGltZy5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xuICB9KTtcbn1cblxuLy8gRG9zeWEgdmFsaWRhc3lvbnVcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZUltYWdlKGZpbGU6IEZpbGUpOiB7IGlzVmFsaWQ6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0ge1xuICAvLyBEb3N5YSBib3l1dHUga29udHJvbMO8ICgxME1CKVxuICBjb25zdCBtYXhTaXplID0gMTAgKiAxMDI0ICogMTAyNDtcbiAgaWYgKGZpbGUuc2l6ZSA+IG1heFNpemUpIHtcbiAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3I6ICdEb3N5YSBib3l1dHUgMTBNQlxcJ2RhbiBiw7x5w7xrIG9sYW1hei4nIH07XG4gIH1cblxuICAvLyBEb3N5YSB0aXBpIGtvbnRyb2zDvFxuICBjb25zdCBhbGxvd2VkVHlwZXMgPSBbJ2ltYWdlL2pwZWcnLCAnaW1hZ2UvanBnJywgJ2ltYWdlL3BuZycsICdpbWFnZS93ZWJwJ107XG4gIGlmICghYWxsb3dlZFR5cGVzLmluY2x1ZGVzKGZpbGUudHlwZSkpIHtcbiAgICByZXR1cm4geyBpc1ZhbGlkOiBmYWxzZSwgZXJyb3I6ICdTYWRlY2UgSlBFRywgUE5HIHZlIFdlYlAgZm9ybWF0bGFyxLEgZGVzdGVrbGVuaXIuJyB9O1xuICB9XG5cbiAgcmV0dXJuIHsgaXNWYWxpZDogdHJ1ZSB9O1xufVxuXG4vLyBHw7Zyc2VsIG1ldGFkYXRhJ3PEsW7EsSBhbFxuZXhwb3J0IGZ1bmN0aW9uIGdldEltYWdlTWV0YWRhdGEoZmlsZTogRmlsZSk6IFByb21pc2U8SW1hZ2VNZXRhZGF0YT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGNvbnN0IGltZyA9IG5ldyBJbWFnZSgpO1xuICAgIFxuICAgIGltZy5vbmxvYWQgPSAoKSA9PiB7XG4gICAgICByZXNvbHZlKHtcbiAgICAgICAgd2lkdGg6IGltZy5uYXR1cmFsV2lkdGgsXG4gICAgICAgIGhlaWdodDogaW1nLm5hdHVyYWxIZWlnaHQsXG4gICAgICAgIGZvcm1hdDogZmlsZS50eXBlLFxuICAgICAgICBzaXplOiBmaWxlLnNpemUsXG4gICAgICAgIGFzcGVjdFJhdGlvOiBpbWcubmF0dXJhbFdpZHRoIC8gaW1nLm5hdHVyYWxIZWlnaHRcbiAgICAgIH0pO1xuICAgIH07XG4gICAgXG4gICAgaW1nLm9uZXJyb3IgPSAoKSA9PiByZWplY3QobmV3IEVycm9yKCdHw7Zyc2VsIG1ldGFkYXRhIGFsxLFuYW1hZMSxJykpO1xuICAgIGltZy5zcmMgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xuICB9KTtcbn1cblxuLy8gR8O2cnNlbCBzaWxtZSBmb25rc2l5b251XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlSW1hZ2UoaW1hZ2VVcmw6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICB0cnkge1xuICAgIGNvbnN0IGltYWdlUmVmID0gcmVmKHN0b3JhZ2UsIGltYWdlVXJsKTtcbiAgICBhd2FpdCBkZWxldGVPYmplY3QoaW1hZ2VSZWYpO1xuICAgIGNvbnNvbGUubG9nKCfinIUgR8O2cnNlbCBiYcWfYXLEsXlsYSBzaWxpbmRpJyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4p2MIEfDtnJzZWwgc2lsbWUgaGF0YXPEsTonLCBlcnJvcik7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdHw7Zyc2VsIHNpbGluZW1lZGknKTtcbiAgfVxufSAiXSwibmFtZXMiOlsic3RvcmFnZSIsInJlZiIsInVwbG9hZEJ5dGVzIiwiZ2V0RG93bmxvYWRVUkwiLCJkZWxldGVPYmplY3QiLCJ0ZXN0RmlyZWJhc2VTdG9yYWdlQ29ubmVjdGlvbiIsImNvbnNvbGUiLCJsb2ciLCJ0ZXN0RGF0YSIsIkJsb2IiLCJ0eXBlIiwidGVzdFJlZiIsImRvd25sb2FkVVJMIiwiZXJyb3IiLCJ1cGxvYWRSZXN0YXVyYW50SW1hZ2UiLCJmaWxlIiwicmVzdGF1cmFudElkIiwib3B0aW9ucyIsImZpbGVOYW1lIiwibmFtZSIsImZpbGVTaXplIiwic2l6ZSIsInRvRml4ZWQiLCJmaWxlVHlwZSIsInN0b3JhZ2VDb25maWciLCJidWNrZXQiLCJhcHAiLCJzdG9yYWdlQnVja2V0IiwicHJvamVjdElkIiwiaXNTdG9yYWdlQ29ubmVjdGVkIiwiRXJyb3IiLCJ2YWxpZGF0aW9uUmVzdWx0IiwidmFsaWRhdGVJbWFnZSIsImlzVmFsaWQiLCJvblByb2dyZXNzIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsInJlcGxhY2UiLCJmb2xkZXJQYXRoIiwiZmlsZVBhdGgiLCJzdG9yYWdlUmVmIiwiZnVsbFBhdGgiLCJwcm9ncmVzc0ludGVydmFsIiwic2V0SW50ZXJ2YWwiLCJjdXJyZW50UHJvZ3Jlc3MiLCJNYXRoIiwibWluIiwicmFuZG9tIiwidXBsb2FkUmVzdWx0IiwiY2xlYXJJbnRlcnZhbCIsIm1ldGFkYXRhIiwidXBsb2FkRXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJtZXNzYWdlIiwiZXJyb3JDb2RlIiwiY29kZSIsImhhbmRsZVVwbG9hZEVycm9yIiwiZXJyb3JUeXBlIiwiZXJyb3JOYW1lIiwiZXJyb3JTdGFjayIsInN0YWNrIiwiaW5jbHVkZXMiLCJvcHRpbWl6ZUltYWdlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJjYW52YXMiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjdHgiLCJnZXRDb250ZXh0IiwiaW1nIiwiSW1hZ2UiLCJvbmxvYWQiLCJtYXhXaWR0aCIsIm1heEhlaWdodCIsInF1YWxpdHkiLCJ3aWR0aCIsImhlaWdodCIsInJhdGlvIiwiZHJhd0ltYWdlIiwidG9CbG9iIiwiYmxvYiIsIm9wdGltaXplZEZpbGUiLCJGaWxlIiwiZm9ybWF0IiwibGFzdE1vZGlmaWVkIiwic3JjIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwibWF4U2l6ZSIsImFsbG93ZWRUeXBlcyIsImdldEltYWdlTWV0YWRhdGEiLCJyZWplY3QiLCJuYXR1cmFsV2lkdGgiLCJuYXR1cmFsSGVpZ2h0IiwiYXNwZWN0UmF0aW8iLCJvbmVycm9yIiwiZGVsZXRlSW1hZ2UiLCJpbWFnZVVybCIsImltYWdlUmVmIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/services/imageUploadService.ts\n"));

/***/ })

}]);